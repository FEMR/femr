@import femr.common.models.PatientItem
@import femr.ui.controllers.manager.ManagerController
@import femr.ui.views.html.layouts.main

@import collection.JavaConversions._

@(currentUser: femr.common.dtos.CurrentUser, ManageViewModelPost: femr.ui.models.manager.IndexViewModelGet,
        viewModelMedical: femr.ui.models.history.IndexEncounterMedicalViewModel)
@additionalScripts = {
    <script type="text/javascript" src="@routes.Assets.versioned("js/libraries/jquery-2.0.3.min.js")"></script>
    <script type="text/javascript" src="@routes.Assets.versioned("js/libraries/jquery.tablescroll.js")"></script>
    <script type="text/javascript" src="@routes.Assets.versioned("js/history/history.js")"></script>

}
@additionalStyles = {
    <link rel="stylesheet" href="@routes.Assets.versioned("css/libraries/jquery.tablescroll.css")">
    <link rel="stylesheet" href="@routes.Assets.versioned("css/manager/manager.css")">
}

@main("ManagerTab", currentUser, scripts = additionalScripts, styles = additionalStyles) {
    <body>


        <div class="backgroundForWrap">

            <div class ="h1" id="title">
                Manager Table: <br>Information about Triage Patients Checked In Today: @ManageViewModelPost.getToday </div>
            @if(currentUser.getTripId != null) {
                <div class="h2" id="title">TripID: @currentUser.getTripId</div>
            }
            @if(currentUser.getTripId == null) {
                <div class="h2" id="title">
                    TripID: Manager  @currentUser.getFirstName @currentUser.getLastName is not currently assigned to a trip</div>
            }

            <div id="table-container center-panel-grid" >
                <div class="managerWrap">


                    <table id="managersTable">
                        <thead>
                            <tr >
                                <th> Patient ID </th>
                                <th> Name </th>
                                <th> Patient Information </th>
                                <th> Chief Complaint </th>
                                <th> Vitals </th>
                                <th> Narrative </th>
                                <th> Triage Check-In Time </th>
                                <th> Medical Check-In Time </th>
                                <th> Pharmacy Check-In Time </th>
                                <th> Total Time Spent </th>
                            </tr>
                        </thead>
                        <tbody>
                        @if(ManageViewModelPost.getTriagePatients != null) {
                            @for(y <- 1 to ManageViewModelPost.getTriagePatients.size) {
                                @defining(ManageViewModelPost.getVitals(y - 1)) { vital =>
                                    @defining(ManageViewModelPost.getTriagePatients.get(y - 1)) { item =>
                                        @defining(ManageViewModelPost.getEncounter.get(y - 1)) { encounter =>
                                            @if(!encounter.getIsClosed) {
                                                <tr class="form-history">
                                                    <td>@item.getId</td>
                                                    <td>@item.getFirstName @item.getLastName</td>
                                                    <td>
                                                        @if(item.getSex() != null) {
                                                            <strong>Gender: </strong> @item.getSex <br>
                                                        }
                                                        @if(item.getAge() != null) {
                                                            <strong>Age: </strong> @item.getAge <br>
                                                        }
                                                        @if(item.getBirth() != null) {
                                                            <strong>Date Of Birth:</strong> @item.getBirth <br>
                                                        }
                                                        @if(item.getHeightFeet != null) {
                                                            <strong>
                                                                Height(m): </strong> @item.getHeightFeet
                                                            .@item.getHeightInches <br>
                                                        }
                                                        @if(item.getCity() != null) {
                                                            <strong>City: </strong> @item.getCity <br>
                                                        }
                                                        @if(item.getWeight() != null) {
                                                            <strong> Weight(kg): </strong> @item.getWeight
                                                        }
                                                    </td>
                                                    <td>@encounter.getChiefComplaints </td>

                                                    <td > <div class="scrollable">
                                                    @for(dateIndex <- 1 to vital.getDateListChronological.size) {
                                                        <strong>Date:</strong> @vital.getDate(dateIndex - 1)
                                                        <br>
                                                        @if(vital.get("heartRate", vital.getDate(dateIndex - 1))) {
                                                            <strong>
                                                                Heart Rate</strong> @vital.get("heartRate", vital.getDate(dateIndex - 1))
                                                            bpm
                                                        }
                                                        <br>

                                                        @if(vital.get("temperature", vital.getDate(dateIndex - 1))) {
                                                            <strong>
                                                                Temperature:</strong> @vital.get("temperature", vital.getDate(dateIndex - 1))
                                                            F
                                                        }
                                                        <br>
                                                        @if(vital.get("bloodPressureSystolic", vital.getDate(dateIndex - 1))) {
                                                            <strong>
                                                                Blood Pressure Systolic:</strong> @vital.get("bloodPressureSystolic", vital.getDate(dateIndex - 1))
                                                        }
                                                        <br>
                                                        @if(vital.get("bloodPressureDiastolic", vital.getDate(dateIndex - 1))) {
                                                            <strong>
                                                                Blood Pressure Diastolic:</strong> @vital.get("bloodPressureDiastolic", vital.getDate(dateIndex - 1))
                                                        }
                                                        <br>
                                                        @if(vital.get("respiratoryRate", vital.getDate(dateIndex - 1))) {
                                                            <strong>
                                                                Respiratory Rate:</strong> @vital.get("respiratoryRate", vital.getDate(dateIndex - 1))
                                                            bpm
                                                        }
                                                        <br>
                                                        @if(vital.get("oxygenSaturation", vital.getDate(dateIndex - 1))) {
                                                            <strong>
                                                                Oxygen Saturation:</strong> @vital.get("oxygenSaturation", vital.getDate(dateIndex - 1))
                                                            %
                                                        }
                                                        <br>
                                                        @if(vital.get("glucose", vital.getDate(dateIndex - 1))) {
                                                            <strong>
                                                                Glucose:</strong> @vital.get("glucose", vital.getDate(dateIndex - 1))
                                                            mg/dl
                                                        }
                                                        <br>
                                                        <br>
                                                        }
                                                    </div> </td>
                                                    @if(ManageViewModelPost.getHPI(y - 1).get("narrative") != null) {
                                                        <td>@ManageViewModelPost.getHPI(y - 1).get("narrative").getValue()</td>
                                                    } else {
                                                        <td>  </td>
                                                    }
                                                    @if(encounter.getTriageDateOfVisit != null) {
                                                        <td>@ManageViewModelPost.getTimeOfTriageVisit(y - 1)</td>
                                                    }
                                                    @if(encounter.getMedicalDateOfVisit != null) {
                                                        <td>@ManageViewModelPost.getTimeOfMedicalVisit(y - 1)</td>
                                                    }
                                                    @if(encounter.getPharmacyDateOfVisit != null) {
                                                        <td>@ManageViewModelPost.getTimeOfPharmVisit(y - 1)</td>
                                                    }
                                                    <td>@ManageViewModelPost.getTurnAroundT(encounter)</td>
                                                </tr>
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        </tbody>
                    </table>

                </div>
            </div>

        </div>

    </body>

}
